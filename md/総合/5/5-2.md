### 5.2 プレイヤー介入イベント（困りごと）の生成

この節では、画面内に一時的に表示される「困りごと」相談イベントの生成および管理に関する内部処理仕様を記述する。これらはプレイヤーが選択または入力で対応することで完了し、信頼度などの変化を引き起こす。

#### 5.2.1 イベント生成タイミングと頻度

##### 自動生成のタイミング：

* ゲーム内時間と同期し、**約1時間ごと**に生成処理を試行
* 画面に既に表示されている相談が**存在しない場合**に限り、新規生成される
* 生成処理は1回につき**1件のみ**

##### 同時発生の制限：

* 複数の相談が**同時に画面上に表示されることはない**
* 既存のイベントがプレイヤーに無視されている間は、次の生成は行われない

#### 5.2.2 対象キャラクターの選定条件

困りごとの発信者となるキャラクターは、以下の条件をすべて満たす必要がある。

##### 必須条件：

* 状態が「就寝中」「風邪」などでない
* **信頼度が一定以上**（具体的には+10以上など）である
* 直近1時間以内に他の困りごとイベントを発生させていない
* 現在ログ上に「信頼度が下がる」イベント等が連続して発生していない

##### 補正条件：

* **信頼度が高いほど発生確率が上昇**
* 外交性・表現力が高いキャラクターは選ばれやすい傾向

#### 5.2.3 内容の選択と形式

困りごとは、以下の2形式のいずれかに分類される：

| 種別   | 内容形式        | プレイヤー操作    |
| ---- | ----------- | ---------- |
| 選択式  | 2～3択のうちから選ぶ | ボタンで回答     |
| 穴埋め式 | 一部が空欄の文章    | キーボード入力で補完 |

##### 相談内容の例：

* 「〇〇ってどう思う？最近ちょっと気になってて…」
* 「この前のこと、〇〇に伝えた方がいいと思う？」

##### 内容の多様性：

* 一定数のテンプレートからランダム選出（個性や関係性で出現制御）
* 過去に同一の相談が表示されたキャラクターには**別の内容を優先的に表示**

#### 5.2.4 回答後の処理と自動消滅

##### プレイヤーが回答した場合：

* 該当キャラが「ありがとう！」などの返答を行い、信頼度変動（上昇 or 停止）を伴って終了
* 回答内容によって信頼度が変化するが、数値は**その場では表示されない**
* ログに「SYSTEM: 〇〇からの信頼度が上昇しました。」等を出力

##### プレイヤーが無視した場合：

* 表示から**約1時間経過後に自動消滅**
* 特別なログ出力は行われない

---

このように、プレイヤー介入イベントは**リアルタイム性と選択一回性を重視**した構成とし、UI上でも自然に表示・終了するように設計されている。